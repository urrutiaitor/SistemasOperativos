package blancanieves;

import java.util.concurrent.locks.Condition;
import java.util.concurrent.locks.Lock;
import java.util.concurrent.locks.ReentrantLock;

public class Mesa {

	int silla[];
	boolean servidos[];
	
	Lock candadoMesa;
	Condition colaEnanitos;
	Condition colaBN;
	
	public Mesa(int numSillas) {
		super();
		
		silla = new int[numSillas];
		servidos = new boolean[numSillas];
		
		candadoMesa = new ReentrantLock();
	}

	public void pasear() {
		try {
			candadoMesa.lock();
			colaBN.await();
			candadoMesa.unlock();
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

	public void servir(int posicion) {
		candadoMesa.lock();
		
		servidos[posicion] = true;
		System.out.println("Blancanieves sirve comida en posicion " + posicion + " a enanito " + silla[posicion]);
		colaEnanitos.signalAll();
		
		candadoMesa.unlock();
	}


	public int encontrarComensal() {
		
		candadoMesa.lock();
		
		for (int i = 0; i < silla.length; i++) {
			if (silla[i] != -1) {
				candadoMesa.unlock();
				return i;
			}
		}
		
		candadoMesa.unlock();
		return -1;
	}

}
