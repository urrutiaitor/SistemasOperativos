package inicial;

import java.awt.RenderingHints.Key;
import java.lang.Thread.State;
import java.util.Scanner;

public class Main {
	
	int numFilosofos;
	long initTime;
	long finalTime;
	Filosofo filosofos[];
	Mesa mesa;

	public static void main(String[] args) {
		Scanner keyboard = new Scanner(System.in);
		long initTime = System.currentTimeMillis();
		System.out.println("Numero de filosofos: ");
		int numFilosofos = keyboard.nextInt();
		new Main(initTime, numFilosofos);
	}
	
	public Main (long initTime, int numFilosofos) {
		Scanner keyboard = new Scanner(System.in);
		this.initTime = initTime;
		this.numFilosofos = numFilosofos;
		
		mesa = new Mesa(numFilosofos);
		filosofos = new Filosofo[numFilosofos];
		
		for (int i = 0; i < numFilosofos; i++) {
			filosofos[i] = new Filosofo(i, mesa);
		}
		for (int i = 0; i < numFilosofos; i++) {
			filosofos[i].start();
		}
		
		while(filosofosEnActivo()) {
			System.out.println("Filosofos trabajando");
			try {
				Thread.sleep(100);
			} catch (InterruptedException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
		}
		finalTime = System.currentTimeMillis();
		long tiempo = (finalTime - initTime)/1000;
		System.out.println("Todos los filosofos bloqueados en " + tiempo + " segundos");
		
	}

	private boolean filosofosEnActivo() {
		for (int i = 0; i < numFilosofos; i++) {
			if (filosofos[i].getState() != State.WAITING) {
				return true;
			}
		}
		return false;
	}

	public int getNumFilosofos() {
		return numFilosofos;
	}

	public void setNumFilosofos(int numFilosofos) {
		this.numFilosofos = numFilosofos;
	}

	public long getInitTime() {
		return initTime;
	}

	public void setInitTime(long initTime) {
		this.initTime = initTime;
	}

	public long getFinalTime() {
		return finalTime;
	}

	public void setFinalTime(long finalTime) {
		this.finalTime = finalTime;
	}
	
	

}
