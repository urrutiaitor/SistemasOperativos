package BufferSincronizadoAlmacenado;

import java.util.concurrent.Semaphore;

public class Buffer {

	int numeros[];
	Semaphore escribir;
	Semaphore leer;
	int indiceLeer;
	int indiceEscribir;
	final int valoresMax = 10;

	public Buffer(Semaphore escribir, Semaphore leer) {
		numeros = new int[valoresMax];
		this.escribir = escribir;
		this.leer = leer;
		indiceLeer = 0;
		indiceEscribir = 0;
	}

	public int getNumero() {
		
		try {
			leer.acquire();
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		int numero = numeros[indiceLeer++%valoresMax];
		escribir.release();
		
		System.out.println("Numero leido: " + numero);
		
		esperar(100);
		
		return numero;
		
	}

	public void setNumero(int numero) {
		
		try {
			escribir.acquire();
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		numeros[indiceEscribir++%valoresMax] = numero;
		leer.release();
		
		System.out.println("Numero escrito: " + numero);
		
		//esperar(500);
		
		System.out.println(visualizarArray());
		
	}
	
	public void esperar(int tiempo){
		try {
			Thread.sleep(tiempo);
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
	
	public String visualizarArray(){
		return "Numeros: [" + numeros[0] + " / " + numeros[1] + " / " + numeros[2] + " / " + numeros[3] + " / "  + numeros[4]
				+ " / " + numeros[5] + " / " + numeros[6] + " / " + numeros[7] + " / " + numeros[8] + " / " + numeros[9] + " ]";
	}
	
}
